<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>GT Greek Life</title>
  <!-- Bootstrap core CSS-->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom fonts for this template-->
  <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <!-- Page level plugin CSS-->
  <link href="vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet">
  <!-- Custom styles for this template-->
  <link href="css/sb-admin.css" rel="stylesheet">
</head>

<body class="fixed-nav sticky-footer bg-dark" id="page-top">
  <!-- Navigation-->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
    <a class="navbar-brand" href="index.html"> <i class="fa fa-university"></i> GT Greek Life  <i class="fa fa-university"></i> </a>

    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <form class="form-inline my-2 my-lg-0 mr-lg-2">
            <div class="input-group">
              <input class="form-control" type="text" placeholder="Search for an Organization" style="width: 250px;">
              <span class="input-group-append">
                <button class="btn btn-primary" type="button">
                  <i class="fa fa-search"></i>
                </button>
              </span>
            </div>
          </form>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="modal" data-target="#postModal">
            <i class="fa fa-fw fa-edit"></i> New Post</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="modal" data-target="#profileModal">
            <i class="fa fa-fw fa-user"></i> My Profile</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="modal" data-target="#exampleModal">
            <i class="fa fa-fw fa-sign-out"></i> Logout</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="content-wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-lg-9">
          <!-- Example Bar Chart Card-->
          <div class="card mb-3">
            <div class="card-header">
              <i class="fa fa-newspaper-o"></i> Feed</div>
            <div class="card-body">
              <div class="card-columns" id="posts">

              </div>
              <!-- /Card Columns-->
            </div>
          </div>
        </div>
        <div class="col-lg-3">
          <!-- Example Bar Chart Card-->
          <div class="card mb-3">
            <div class="card-header">
              <i class="fa fa-bars"></i> Categories</div>
            <div class="card-body">
              <div class="card text-white bg-secondary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-fw fa-newspaper-o"></i>
                  </div>
                  <div class="mr-5">Feed</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#" id="viewFeed">
                  <span class="float-left">View Feed</span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              </div>
              <br>
              <div class="card text-white bg-info o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-fw fa-users"></i>
                  </div>
                  <div class="mr-5">Operations</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#" id="viewOperations">
                  <span class="float-left">View Feed</span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              </div>
              <br>
              <div class="card text-white bg-warning o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-fw fa-comments"></i>
                  </div>
                  <div class="mr-5">Social Events</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#" id="viewSocial">
                  <span class="float-left">View Feed</span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              </div>
              <br>
              <div class="card text-white bg-danger o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-fw fa-university"></i>
                  </div>
                  <div class="mr-5">Student Life</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#" id="viewLife">
                  <span class="float-left">View Feed</span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              </div>
              <br>
              <div class="card text-white bg-success o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-fw fa-book"></i>
                  </div>
                  <div class="mr-5">Academics</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#" id="viewAcademics">
                  <span class="float-left">View Feed</span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              </div>
              <br>
              <div class="card text-white bg-primary o-hidden h-100">
                <div class="card-body">
                  <div class="card-body-icon">
                    <i class="fa fa-fw fa-handshake-o"></i>
                  </div>
                  <div class="mr-5">Philanthropy</div>
                </div>
                <a class="card-footer text-white clearfix small z-1" href="#" id="viewPhilanthropy">
                  <span class="float-left">View Feed</span>
                  <span class="float-right">
                    <i class="fa fa-angle-right"></i>
                  </span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /.container-fluid-->
    <!-- /.content-wrapper-->
    <footer class="sticky-footer">
      <div class="container">
        <div class="text-center">
          <small>Copyright © Lambda Chi Alpha | BK | 2018</small>
        </div>
      </div>
    </footer>
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fa fa-angle-up"></i>
    </a>
    <!-- Profile Modal-->
  <div class="modal fade" id="profileModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Username</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
        </div>
<!-- logoutmodal-- >
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
          <div class="modal-footer">
            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            <a class="btn btn-primary" href="login.html">Logout</a>
          </div>
        </div>
      </div>
    </div>
    <!-- Post Modal-->
    <div class="modal fade" id="postModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">New Post</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <form id="post-form">
            <div class="modal-body">
              <div class="form-group">
                <label for="title">Title</label>
                <input class="form-control" id="title" type="text" placeholder="Title" required>
              </div>
              <div class="form-group">
                <label for="type">Category</label>
                <select class="form-control" id="type" required>
                  <option disabled="disabled" selected="selected">Choose a Category</option>
                  <option value="0">Operations</option>
                  <option value="1">Social Events</option>
                  <option value="2">Student Life</option>
                  <option value="3">Academics</option>
                  <option value="4">Philanthropy</option>
                </select>
              </div>
              <div class="form-group">
                <label for="content">Post Body</label>
                <textarea class="form-control" id="content" type="text" placeholder="Post Body" rows="5" required></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
              <button class="btn btn-primary" type="submit">Post</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <!-- Page level plugin JavaScript-->
    <script src="vendor/chart.js/Chart.min.js"></script>
    <script src="vendor/datatables/jquery.dataTables.js"></script>
    <script src="vendor/datatables/dataTables.bootstrap4.js"></script>
    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin.min.js"></script>
    <script>
      var category = -1;
      var id;

      var categories = [
          'Operations',
          'Social Events',
          'Student Life',
          'Academics',
          'Philanthropy'
      ];

      var posts = [];

      $("#post-form").submit(function(e) {
          e.preventDefault();
          var title = $("#title").val();
          var type = $("#type").val();
          var content = $("#content").val();
          $.ajax({
              type: 'POST',
              url: '/api/newpost',
              data: {'title': title, 'type': type, 'content': content},
              success: function() {
                  $("#postModal").modal('hide');
                  getPosts();
              }
          });
      });

      var filterPosts = function() {
          $("#posts").html('');
          posts.forEach(function(post) {
              if (category != -1 && post.type != category) {
                  return;
              }
              var type = categories[post.type];
              var template = `<div class="card mb-3">
                        <div class="card-body">
                          <h5 class="card-title mb-1">${post.title}</h5>
                          <h6 class="card-title mb-1">${post.username}</h6>
                          <p class="card-text small">${type}<br>
                          ${post.content}
                          </p>
                        </div>
                        <hr class="my-0">
                        <div class="card-body py-2 small">
                          <a class="mr-3 d-inline-block" href="#">
                            <i class="fa fa-fw fa-thumbs-up"></i>Like</a>
                        </div>
                      </div>`;
              $("#posts").append(template);
          });
      };

      var getPosts = function() {
          $.ajax({
              type: 'GET',
              url: '/api/allposts',
              dataType: 'json',
              success: function(data) {
                  posts = data;
                  filterPosts();
              }
          })
      };

      var getID = function() {
          $.ajax({
              type: 'GET',
              url: '/api/me',
              dataType: 'json',
              success: function(data) {
                  id = data.id;
              }
          })
      };

      var setCategory = function (type) {
          category = type;
          filterPosts();
      };

      $(document).ready(function() {
          getPosts();
          getID();
      });

      $("#viewFeed").click(function() {
          setCategory(-1);
      });
      $("#viewOperations").click(function() {
          setCategory(0);
      });
      $("#viewSocial").click(function() {
          setCategory(1);
      });
      $("#viewLife").click(function() {
          setCategory(2);
      });
      $("#viewAcademics").click(function() {
          setCategory(3);
      });
      $("#viewPhilanthropy").click(function() {
          setCategory(4);
      });
    </script>
  </div>
</body>

</html>
